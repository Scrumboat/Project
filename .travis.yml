---
language: ruby
rvm:
- 1.9.3
env:
  global:
  - secure: ! 'tiNkiaqjX/jqFhDsxomvgqIkqYE9kVpyvurTPieuHfa6VXzP3tBe+uMRbmf5

      XIyxSY1QJwrml9vOHf5+E+src7+9GByt6G3Xl7y9vP/J6Ec8abTpqOOsPSxi

      88FQbvb8ZPTKRh3yAnRNu7vJxYKB1gLafc+1dVe0D7tJdJZ6S68='

before_script: bundle exec rake db:migrate
script: bundle exec rake test cucumber
notifications:
  email: false
  irc:
    channels:
    - ircnet.eversible.com#scrumcaptain
    use_notice: true
    skip_join: true
    template:
    - ! '----'
    - ! '%{message}'
    - ! '%{repository}/%{branch}#%{build_number} (%{author})'
    - ! 'Commit message : %{commit_message}'
    - ! 'Build details  : %{build_url}'
    - ! '----'
after_success:
- wget -qO- https://toolbelt.heroku.com/install-ubuntu.sh | sh
- git remote add heroku git@heroku.com:scrumboat.git
- echo "Host heroku.com" >> ~/.ssh/config
- echo "   StrichHostKeyChecking no" >> ~/.ssh/config
- echo "   CheckHostIP no" >> ~/.ssh/config
- echo "   UserKnownHostsFile=/dev/null" >> ~/.ssh/config
- heroku keys:clear
- yes | heroku keys:add
- yes | git push heroku master
- yes | heroku run rake db:migrate
